TIMER EQU 10h
EOI EQU 20h
IMR EQU 21h
INT1 EQU 25h
PA EQU 30h
PB EQU 31h
CA EQU 32h
CB EQU 33h
ID_CLK EQU 10

ORG 40
IP_CLK DW RUT_CLK

ORG 3000h
RUT_CLK: PUSH AX
  MOV AL, DL
  OUT PB, AL
  CMP DL, 0
  JZ ES_CERO
  ADD DL, DL
  JMP SIGO
ES_CERO: MOV DL, 1
  ; Reinicio timer
SIGO: MOV AL, 0
  OUT TIMER, AL
  MOV AL, EOI
  OUT EOI, AL
  POP AX
  IRET

ORG 2000h
  CLI
    MOV AL, 0FDh
    OUT IMR, AL
    MOV AL, ID_CLK
    OUT INT1, AL
    MOV AL, 1
    OUT TIMER+1, AL
    MOV AL, 0
    OUT TIMER, AL
    OUT CB, AL
    OUT PB, AL
    MOV DL, 0
  STI
  LOOP: JMP LOOP
  INT 0
END