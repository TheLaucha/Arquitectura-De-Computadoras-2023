EOI EQU 20h
IMR EQU 21h
INT0 EQU 24h
ID_F10 EQU 10
PA EQU 30h
PB EQU 31h
CA EQU 32h
CB EQU 33h

ORG 40
IP_F10 DW RUT_F10

ORG 1000h
  MSJ DB "INGRESE 5 CARACTERES"
  FIN_MSJ DB ?
  CANT DB 10
  CAR DB ?

ORG 3000h
RUT_F10: PUSH AX
  MOV DL, CANT
  MOV BX, OFFSET CAR
OTRO: IN AL, PA
  AND AL, 1
  JNZ OTRO
  MOV AL, [BX]
  OUT PB, AL
  CALL PULSO
  INC BX
  DEC DL
  JNZ OTRO
  MOV AL, EOI
  OUT EOI, AL
  POP AX
  IRET

PULSO: IN AL, PA
  OR AL, 2
  OUT PA, AL
  IN AL, PA
  AND AL, 0Fdh
  OUT PA, AL
  RET

CONF_PIO: MOV AL, 0FDh
  OUT CA, AL
  MOV AL, 00h
  OUT CB, AL
  RET

ORG 2000h
  CLI
    MOV AL, 0FEh ; 1111 1110
    OUT IMR, AL
    MOV AL, ID_F10
    OUT INT0, AL
  STI
  ; Configuro PIO
  CALL CONF_PIO
  ; Muestro Mensaje
  MOV BX, OFFSET MSJ
  MOV AL, OFFSET FIN_MSJ - OFFSET MSJ
  INT 7
  MOV DL, CANT
  MOV BX, OFFSET CAR
LOOP: INT 6
  INC BX
  DEC DL
  JNZ LOOP
INF: JMP INF
  INT 0
END