EOI EQU 20h
IMR EQU 21h
INT2 EQU 26h
ID_HAND EQU 10
ID_HAND_2 EQU 20
DATO EQU 40h
ESTADO EQU 41h

ORG 40
IP_HAND DW RUT_HAND

ORG 80
IP_HAND_2 DW RUT_HAND_2

ORG 1000h
  MSJ DB "INGRESE 5 CARACTERES"
  FIN_MSJ DB ?
  CANT DB 5
  CAD DB ?
  
ORG 3000h
IMP_MENSAJE: MOV BX, OFFSET MSJ
  MOV AL, OFFSET FIN_MSJ - OFFSET MSJ
  INT 7
  RET

RUT_HAND: PUSH AX
  MOV AL, [BX]
  OUT DATO, AL
  INC BX
  DEC DL
  JNZ FINAL
  MOV AL, 0FFh
  OUT IMR, AL
FINAL: MOV AL, EOI
  OUT EOI, AL
  POP AX
  IRET

RUT_HAND_2: PUSH AX
  MOV AL, [BX]
  OUT DATO, AL
  DEC BX
  DEC DL
  JNZ FINAL_2
  MOV AL, 0FFh
  OUT IMR, AL
FINAL_2: MOV AL, EOI
  OUT EOI, AL
  POP AX
  IRET

ORG 2000h
  CALL IMP_MENSAJE
  MOV DL, CANT
  MOV BX, OFFSET CAD
OTRO: INT 6
  INC BX
  DEC DL
  JNZ OTRO
  CLI
    MOV AL, 0FBh ; 1111 1011
    OUT IMR, AL
    MOV AL, ID_HAND
    OUT INT2, AL
    MOV AL, 80h
    OUT ESTADO, AL
    MOV BX, OFFSET CAD
    MOV DL, CANT
  STI
LOOP: CMP DL, 0 
  JNZ LOOP
  CLI
    MOV AL, ID_HAND_2
    OUT INT2, AL
    MOV AL, 0FBh
    OUT IMR, AL
    DEC BX
    MOV DL, CANT
  STI
LOOP2: JMP LOOP2
  INT 0
END