TIMER EQU 10h
EOI EQU 20h
IMR EQU 21h
INT0 EQU 24h
INT1 EQU 25h
ID_CLK EQU 10
ID_F10 EQU 20

ORG 40
IP_CLK DW RUT_CLK

ORG 80
IP_F10 DW RUT_F10

ORG 1000H
  MSJ DB "Escriba un numero desde el que se realizara el conteo regresivo."
  FIN_MSJ DB ?
  NUM DB ?

ORG 3000H
RUT_CLK: PUSH AX
  CMP NUM, 30h
  JNZ SIGO
  MOV AL, 0FFh
  OUT IMR, AL
  INC DL
SIGO: MOV AL, 1 
  INT 7 
  DEC NUM
  MOV AL, 0
  OUT TIMER, AL
  MOV AL, EOI
  OUT EOI, AL
  POP AX
  IRET

ORG 3500h
RUT_F10: PUSH AX
  IN AL, IMR
  XOR AL, 00000010b
  OUT IMR, AL
  MOV AL, EOI
  OUT EOI, AL
  POP AX
  IRET

ORG 2000H
  CLI
    MOV BX, OFFSET MSJ
    MOV AL, OFFSET FIN_MSJ - OFFSET MSJ
    INT 7
    MOV BX, OFFSET NUM
    INT 6
    MOV AL, 0FEh; 1111 1110
    OUT IMR, AL
    MOV AL, ID_F10
    OUT INT0, AL
    MOV AL, ID_CLK
    OUT INT1, AL
    MOV AL, 1
    OUT TIMER+1, AL
    MOV AL, 0
    OUT TIMER, AL
    MOV DL, 0
  STI
LOOP: CMP DL, 0
  JZ LOOP
  INT 0
END